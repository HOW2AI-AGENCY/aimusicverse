# üìã SDD: Stem Studio Enhancement v3.0

**Epic ID:** E015-Studio-Enhancement  
**–°–æ–∑–¥–∞–Ω–æ:** 2025-12-11  
**–°—Ç–∞—Ç—É—Å:** Planning  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P1 (Critical)

---

## üéØ –¶–µ–ª–∏ –∏ –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

### –ë–∏–∑–Ω–µ—Å-—Ü–µ–ª–∏:
- –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å Studio –≤ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –º—É–∑—ã–∫–∞–Ω—Ç–æ–≤
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π workflow —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–∫–æ–≤
- –£–≤–µ–ª–∏—á–∏—Ç—å engagement –∏ retention —á–µ—Ä–µ–∑ DAW —Ñ—É–Ω–∫—Ü–∏–∏
- –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞—Ç—å—Å—è –æ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ AI-—Ñ—É–Ω–∫—Ü–∏–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ü–µ–ª–∏:
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π Studio
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö API (Suno, Klangio, AuDD)
- Real-time –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –†–∞–±–æ—Ç–∞—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- ‚úÖ –ë–∞–∑–æ–≤–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ç—Ä–µ–∫–æ–≤
- ‚úÖ Waveform –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ Stem separation (–∑–∞–ø—Ä–æ—Å –∫ API)
- ‚úÖ MIDI —ç–∫—Å–ø–æ—Ä—Ç (–±–∞–∑–æ–≤—ã–π)

### –¢—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚ùå –ó–∞–º–µ–Ω–∞ —Å–µ–∫—Ü–∏–∏ (VocalReplacementDialog/ArrangementReplacementDialog)
- ‚ùå MIDI —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è (—É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–µ–π)
- ‚ùå Klangio –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–Ω–µ–ø–æ–ª–Ω–∞—è)
- ‚ùå –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Å—Ç–µ–º–æ–≤

### –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç:
- ‚ùå Timeline —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å–µ–∫—Ü–∏–π
- ‚ùå –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–∏–∫—à–µ—Ä —Å —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
- ‚ùå Export –≤ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- ‚ùå Undo/Redo —Å–∏—Å—Ç–µ–º–∞

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –°–ø—Ä–∏–Ω—Ç–æ–≤

### Sprint 015-A: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤ (2-3 –¥–Ω—è)

**–¶–µ–ª—å:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π

| ID | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å |
|----|--------|-----------|--------|
| T015-A-01 | –ò—Å–ø—Ä–∞–≤–∏—Ç—å VocalReplacementDialog - –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å audioUrl —Å—Ç–µ–º–∞ | P1 | üîÑ |
| T015-A-02 | –ò—Å–ø—Ä–∞–≤–∏—Ç—å ArrangementReplacementDialog - –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å audioUrl —Å—Ç–µ–º–∞ | P1 | üîÑ |
| T015-A-03 | –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–µ–π Replicate –¥–ª—è MIDI —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ | P1 | üîÑ |
| T015-A-04 | –ò—Å–ø—Ä–∞–≤–∏—Ç—å section detection –∏–∑ lyrics | P1 | üîÑ |
| T015-A-05 | –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞–ª–∏—á–∏—è —Å—Ç–µ–º–æ–≤ –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ | P2 | üîÑ |

**Acceptance Criteria:**
- [ ] –ó–∞–º–µ–Ω–∞ –≤–æ–∫–∞–ª–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –µ—Å–ª–∏ –µ—Å—Ç—å instrumental —Å—Ç–µ–º
- [ ] –ó–∞–º–µ–Ω–∞ –∞—Ä–∞–Ω–∂–∏—Ä–æ–≤–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –µ—Å–ª–∏ –µ—Å—Ç—å vocal —Å—Ç–µ–º
- [ ] MIDI —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è
- [ ] –°–µ–∫—Ü–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∏–∑ lyrics

---

### Sprint 015-B: Klangio –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (3-4 –¥–Ω—è)

**–¶–µ–ª—å:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Klangio API –≤–æ –≤—Å–µ —á–∞—Å—Ç–∏ Studio

**‚ö†Ô∏è CRITICAL BLOCKER**: Klangio API generates only 2/5 requested formats (MIDI + MusicXML). PDF, GP5, and MIDI Quantized are missing.
**Status**: Diagnostic logging deployed (PR #149), awaiting test results to identify root cause.

| ID | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å |
|----|--------|-----------|--------|
| T015-B-00 | **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Klangio outputs (PR #149)** | **P0** | ‚úÖ **DONE** |
| T015-B-00a | Deploy Edge Function —Å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π | P0 | ‚è≥ **PENDING** |
| T015-B-00b | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ | P0 | ‚è≥ **PENDING** |
| T015-B-00c | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ identified root cause | P0 | ‚è≥ **BLOCKED** |
| T015-B-01 | –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ klangio-analyze –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ | P1 | üîÑ |
| T015-B-02 | –î–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ (guitar/piano/universal) | P1 | üîÑ |
| T015-B-03 | –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å chord recognition —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π | P1 | üîÑ |
| T015-B-04 | –î–æ–±–∞–≤–∏—Ç—å beat tracking —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ –Ω–∞ waveform | P1 | üîÑ |
| T015-B-05 | –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –≤ GP5, MusicXML, PDF | P2 | üö´ **BLOCKED** |
| T015-B-06 | –î–æ–±–∞–≤–∏—Ç—å strumming pattern –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é | P2 | üîÑ |

**Diagnostic Enhancement (PR #149):**
- ‚úÖ Added 5 strategic log points in klangio-analyze Edge Function
- ‚úÖ Logs query params construction, final endpoint URL, API response flags
- ‚úÖ Merged with database logging from main branch
- ‚è≥ **ACTION REQUIRED**: Deploy and test to identify root cause

**Acceptance Criteria:**
- [x] Diagnostic logging deployed (PR #149) ‚úÖ
- [ ] Root cause identified for missing formats ‚ö†Ô∏è **BLOCKED**
- [ ] All 5 output formats working (MIDI, MIDI Quant, GP5, PDF, MusicXML)
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
- [ ] –ê–∫–∫–æ—Ä–¥—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å waveform
- [ ] BPM –∏ –±–∏—Ç—ã –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –Ω–∞ timeline
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ 4+ —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

### Sprint 015-C: –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–∏–∫—à–µ—Ä (4-5 –¥–Ω–µ–π)

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–∏–∫—à–µ—Ä –¥–ª—è —Å—Ç–µ–º–æ–≤

| ID | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å |
|----|--------|-----------|--------|
| T015-C-01 | –°–æ–∑–¥–∞—Ç—å StemMixer –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å Tone.js | P1 | üîÑ |
| T015-C-02 | –î–æ–±–∞–≤–∏—Ç—å volume faders –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–µ–º–∞ | P1 | üîÑ |
| T015-C-03 | –î–æ–±–∞–≤–∏—Ç—å pan control | P1 | üîÑ |
| T015-C-04 | –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Solo/Mute —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π | P1 | üîÑ |
| T015-C-05 | –î–æ–±–∞–≤–∏—Ç—å EQ (3-band) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–µ–º–∞ | P2 | üîÑ |
| T015-C-06 | –î–æ–±–∞–≤–∏—Ç—å Reverb/Delay —ç—Ñ—Ñ–µ–∫—Ç—ã | P2 | üîÑ |
| T015-C-07 | –î–æ–±–∞–≤–∏—Ç—å Compressor | P3 | üîÑ |
| T015-C-08 | –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ—Å–µ—Ç—ã –º–∏–∫—à–∏—Ä–æ–≤–∞–Ω–∏—è | P3 | üîÑ |

**Acceptance Criteria:**
- [ ] Volume, Pan, Solo, Mute —Ä–∞–±–æ—Ç–∞—é—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–µ–º–∞
- [ ] EQ —Å–ª—ã—à–∏–º–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∑–≤—É–∫
- [ ] –≠—Ñ—Ñ–µ–∫—Ç—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- [ ] –ü—Ä–µ—Å–µ—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

---

### Sprint 015-D: Section Editor (5-6 –¥–Ω–µ–π)

**–¶–µ–ª—å:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å–µ–∫—Ü–∏–π —Å timeline

| ID | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å |
|----|--------|-----------|--------|
| T015-D-01 | –°–æ–∑–¥–∞—Ç—å SectionTimeline –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | P1 | üîÑ |
| T015-D-02 | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ–∫—Ü–∏–π –Ω–∞ timeline (Verse/Chorus/Bridge) | P1 | üîÑ |
| T015-D-03 | Drag –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥—Ä–∞–Ω–∏—Ü —Å–µ–∫—Ü–∏–π | P1 | üîÑ |
| T015-D-04 | Click-to-select —Å–µ–∫—Ü–∏—é | P1 | üîÑ |
| T015-D-05 | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å useSectionDetection | P1 | üîÑ |
| T015-D-06 | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ lyrics –¥–ª—è —Å–µ–∫—Ü–∏–∏ | P2 | üîÑ |
| T015-D-07 | AI regeneration —Å–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ Suno | P2 | üîÑ |
| T015-D-08 | A/B —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ –∏ –∑–∞–º–µ–Ω—ã | P2 | üîÑ |

**Acceptance Criteria:**
- [ ] –°–µ–∫—Ü–∏–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ —Ä–∞–∑–ª–∏—á–∏–º—ã –Ω–∞ timeline
- [ ] –ì—Ä–∞–Ω–∏—Ü—ã —Å–µ–∫—Ü–∏–π –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å drag-and-drop
- [ ] –í—ã–±—Ä–∞–Ω–Ω–∞—è —Å–µ–∫—Ü–∏—è –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç—Å—è
- [ ] –ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å —Å–µ–∫—Ü–∏—é —á–µ—Ä–µ–∑ AI

---

### Sprint 015-E: Export & Rendering (3-4 –¥–Ω—è)

**–¶–µ–ª—å:** –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

| ID | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å |
|----|--------|-----------|--------|
| T015-E-01 | –°–æ–∑–¥–∞—Ç—å ExportDialog –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | P1 | üîÑ |
| T015-E-02 | –≠–∫—Å–ø–æ—Ä—Ç –º–∏–∫—Å–∞ –≤ WAV | P1 | üîÑ |
| T015-E-03 | –≠–∫—Å–ø–æ—Ä—Ç –º–∏–∫—Å–∞ –≤ MP3 (—Å bitrate selection) | P1 | üîÑ |
| T015-E-04 | –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç–µ–º–æ–≤ | P2 | üîÑ |
| T015-E-05 | –≠–∫—Å–ø–æ—Ä—Ç MIDI —Å applied edits | P2 | üîÑ |
| T015-E-06 | Batch export –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ | P3 | üîÑ |

**Acceptance Criteria:**
- [ ] WAV —ç–∫—Å–ø–æ—Ä—Ç –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- [ ] MP3 —Å –≤—ã–±–æ—Ä–æ–º 128/192/320 kbps
- [ ] –ö–∞–∂–¥—ã–π —Å—Ç–µ–º –º–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
- [ ] MIDI —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–æ—Ç—ã –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏

---

### Sprint 015-F: Mobile Optimization (4-5 –¥–Ω–µ–π)

**–¶–µ–ª—å:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ Studio –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö

| ID | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å |
|----|--------|-----------|--------|
| T015-F-01 | –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π layout –¥–ª—è –º–∏–∫—à–µ—Ä–∞ | P1 | üîÑ |
| T015-F-02 | Touch-friendly controls (44px+) | P1 | üîÑ |
| T015-F-03 | Swipe navigation –º–µ–∂–¥—É —Ç–∞–±–∞–º–∏ | P1 | üîÑ |
| T015-F-04 | Haptic feedback –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π | P2 | üîÑ |
| T015-F-05 | Bottom sheet –¥–ª—è section editor | P2 | üîÑ |
| T015-F-06 | Gesture controls –¥–ª—è waveform (pinch-to-zoom) | P2 | üîÑ |
| T015-F-07 | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | P2 | üîÑ |

**Acceptance Criteria:**
- [ ] –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ 375px —ç–∫—Ä–∞–Ω–µ
- [ ] Touch targets ‚â• 44px
- [ ] Swipe —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–∞–≤–Ω–æ (60fps)
- [ ] Haptic feedback –Ω–∞ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö

---

### Sprint 015-G: History & Undo System (3-4 –¥–Ω—è)

**–¶–µ–ª—å:** –°–∏—Å—Ç–µ–º–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

| ID | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å |
|----|--------|-----------|--------|
| T015-G-01 | –°–æ–∑–¥–∞—Ç—å useStudioHistory hook | P1 | üîÑ |
| T015-G-02 | Track volume/pan/mute changes | P1 | üîÑ |
| T015-G-03 | Track section edits | P1 | üîÑ |
| T015-G-04 | Implement Undo (Ctrl+Z) | P1 | üîÑ |
| T015-G-05 | Implement Redo (Ctrl+Shift+Z) | P1 | üîÑ |
| T015-G-06 | Visual history timeline | P2 | üîÑ |
| T015-G-07 | Restore to any point | P2 | üîÑ |

**Acceptance Criteria:**
- [ ] Undo/Redo —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ session
- [ ] Keyboard shortcuts —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ú–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ª—é–±–æ–π —Ç–æ—á–∫–µ –∏—Å—Ç–æ—Ä–∏–∏

---

## üìÅ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/components/stem-studio/
‚îú‚îÄ‚îÄ StudioProvider.tsx           # Context —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
‚îú‚îÄ‚îÄ StemStudioContent.tsx        # –û—Å–Ω–æ–≤–Ω–æ–π layout
‚îú‚îÄ‚îÄ 
‚îú‚îÄ‚îÄ mixer/
‚îÇ   ‚îú‚îÄ‚îÄ StemMixer.tsx            # –û—Å–Ω–æ–≤–Ω–æ–π –º–∏–∫—à–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ StemChannel.tsx          # –ö–∞–Ω–∞–ª –æ–¥–Ω–æ–≥–æ —Å—Ç–µ–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ VolumeSlider.tsx         # Volume fader
‚îÇ   ‚îú‚îÄ‚îÄ PanKnob.tsx              # Pan control
‚îÇ   ‚îú‚îÄ‚îÄ EffectsRack.tsx          # EQ, Reverb, Compressor
‚îÇ   ‚îî‚îÄ‚îÄ MixerPresets.tsx         # –ü—Ä–µ—Å–µ—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ timeline/
‚îÇ   ‚îú‚îÄ‚îÄ SectionTimeline.tsx      # Timeline —Å–µ–∫—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ SectionMarker.tsx        # –ú–∞—Ä–∫–µ—Ä —Å–µ–∫—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ WaveformDisplay.tsx      # Waveform
‚îÇ   ‚îî‚îÄ‚îÄ PlayheadCursor.tsx       # –ö—É—Ä—Å–æ—Ä –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ editor/
‚îÇ   ‚îú‚îÄ‚îÄ SectionEditor.tsx        # –†–µ–¥–∞–∫—Ç–æ—Ä —Å–µ–∫—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ LyricsEditor.tsx         # –†–µ–¥–∞–∫—Ç–æ—Ä lyrics
‚îÇ   ‚îú‚îÄ‚îÄ SectionComparison.tsx    # A/B —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ ReplaceSectionDialog.tsx # –î–∏–∞–ª–æ–≥ –∑–∞–º–µ–Ω—ã
‚îÇ
‚îú‚îÄ‚îÄ analysis/
‚îÇ   ‚îú‚îÄ‚îÄ KlangioToolsPanel.tsx    # Klangio –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ ChordDisplay.tsx         # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–∫–∫–æ—Ä–¥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ BeatMarkers.tsx          # –ú–∞—Ä–∫–µ—Ä—ã –±–∏—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ MidiViewer.tsx           # MIDI –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ export/
‚îÇ   ‚îú‚îÄ‚îÄ ExportDialog.tsx         # –î–∏–∞–ª–æ–≥ —ç–∫—Å–ø–æ—Ä—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ FormatSelector.tsx       # –í—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ RenderProgress.tsx       # –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ–Ω–¥–µ—Ä–∞
‚îÇ
‚îî‚îÄ‚îÄ mobile/
    ‚îú‚îÄ‚îÄ MobileStudioLayout.tsx   # –ú–æ–±–∏–ª—å–Ω—ã–π layout
    ‚îú‚îÄ‚îÄ MobileMixer.tsx          # –ú–æ–±–∏–ª—å–Ω—ã–π –º–∏–∫—à–µ—Ä
    ‚îî‚îÄ‚îÄ MobileSectionEditor.tsx  # –ú–æ–±–∏–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä

src/hooks/studio/
‚îú‚îÄ‚îÄ useStudioState.ts            # –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
‚îú‚îÄ‚îÄ useStudioHistory.ts          # Undo/Redo
‚îú‚îÄ‚îÄ useStemMixer.ts              # Tone.js –º–∏–∫—à–µ—Ä
‚îú‚îÄ‚îÄ useSectionEditor.ts          # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–π
‚îú‚îÄ‚îÄ useKlangioAnalysis.ts        # Klangio –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ useAudioExport.ts            # –≠–∫—Å–ø–æ—Ä—Ç –∞—É–¥–∏–æ
```

---

## ‚è±Ô∏è –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

| Sprint | –ó–∞–¥–∞—á–∏ | –û—Ü–µ–Ω–∫–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|--------|--------|--------|-----------|
| 015-A | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤ | 2-3 –¥–Ω—è | P1 |
| 015-B | Klangio –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | 3-4 –¥–Ω—è | P1 |
| 015-C | –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–∏–∫—à–µ—Ä | 4-5 –¥–Ω–µ–π | P1 |
| 015-D | Section Editor | 5-6 –¥–Ω–µ–π | P1 |
| 015-E | Export & Rendering | 3-4 –¥–Ω—è | P2 |
| 015-F | Mobile Optimization | 4-5 –¥–Ω–µ–π | P2 |
| 015-G | History & Undo | 3-4 –¥–Ω—è | P2 |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: 24-31 –¥–µ–Ω—å (5-6 –Ω–µ–¥–µ–ª—å)**

---

## üéØ Success Criteria

1. **SC-001**: –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–º–µ–Ω—ã (vocal/arrangement/section) —Ä–∞–±–æ—Ç–∞—é—Ç
2. **SC-002**: MIDI —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Å—Ç–µ–º–æ–≤
3. **SC-003**: –ú–∏–∫—à–µ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ —Å–≤–æ–¥–∏—Ç—å —Å—Ç–µ–º—ã
4. **SC-004**: Section editor –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã —Å–µ–∫—Ü–∏–π
5. **SC-005**: –≠–∫—Å–ø–æ—Ä—Ç –≤ WAV/MP3 —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
6. **SC-006**: Studio —É–¥–æ–±–Ω–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö (>85 Lighthouse mobile)
7. **SC-007**: Undo/Redo —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üîó Dependencies

### –í–Ω–µ—à–Ω–∏–µ API:
- SunoAPI.org - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º—É–∑—ã–∫–∏, –∑–∞–º–µ–Ω–∞ —Å–µ–∫—Ü–∏–π
- Klangio - —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è, –∞–∫–∫–æ—Ä–¥—ã, –±–∏—Ç—ã
- Replicate (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è

### NPM –ø–∞–∫–µ—Ç—ã:
- `tone` - –∞—É–¥–∏–æ —Å–∏–Ω—Ç–µ–∑ –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã
- `wavesurfer.js` - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è waveform
- `@tonejs/midi` - MIDI –æ–±—Ä–∞–±–æ—Ç–∫–∞
- `lamejs` - MP3 encoding

### –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ API:
- Web Audio API
- MediaRecorder API
- File System Access API (–¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞)
