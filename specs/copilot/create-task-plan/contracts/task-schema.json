{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://musicverse.how2ai.world/schemas/task-list.schema.json",
  "title": "Task List Schema",
  "description": "Schema for validating task list documents (tasks.md)",
  "type": "object",
  "required": ["frontmatter", "tasks"],
  "properties": {
    "frontmatter": {
      "type": "object",
      "required": ["feature", "phase", "date", "total_tasks", "p1_tasks", "p2_tasks", "p3_tasks"],
      "properties": {
        "feature": {
          "type": "string",
          "description": "Name of the feature",
          "minLength": 3
        },
        "phase": {
          "type": "string",
          "const": "Phase 2 - Implementation",
          "description": "Must be Phase 2"
        },
        "date": {
          "type": "string",
          "format": "date",
          "description": "Task list creation date"
        },
        "total_tasks": {
          "type": "integer",
          "minimum": 1,
          "description": "Total number of tasks"
        },
        "p1_tasks": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of P1 (highest priority) tasks"
        },
        "p2_tasks": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of P2 (medium priority) tasks"
        },
        "p3_tasks": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of P3 (low priority) tasks"
        }
      }
    },
    "tasks": {
      "type": "array",
      "description": "List of all tasks",
      "items": {
        "type": "object",
        "required": ["id", "title", "priority", "userStory", "description", "acceptanceCriteria", "estimate"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^T-\\d{3}$",
            "description": "Unique task identifier (e.g., T-001)",
            "examples": ["T-001", "T-042"]
          },
          "title": {
            "type": "string",
            "description": "Brief task title",
            "minLength": 10,
            "maxLength": 100
          },
          "priority": {
            "type": "string",
            "enum": ["P1", "P2", "P3"],
            "description": "Task priority (P1 = highest, P3 = lowest)"
          },
          "userStory": {
            "type": "string",
            "description": "Reference to original user story",
            "pattern": "^User Story \\d+",
            "examples": ["User Story 1", "User Story 2 - Generate Music"]
          },
          "description": {
            "type": "string",
            "description": "Detailed task description",
            "minLength": 50,
            "maxLength": 500
          },
          "acceptanceCriteria": {
            "type": "array",
            "description": "Testable outcomes for task completion",
            "items": {
              "type": "string"
            },
            "minItems": 2,
            "examples": [
              [
                "Database schema created with all required fields",
                "Migration script tested on local database",
                "RLS policies applied and tested"
              ]
            ]
          },
          "dependencies": {
            "type": "array",
            "description": "Other task IDs this task depends on",
            "items": {
              "type": "string",
              "pattern": "^T-\\d{3}$"
            },
            "examples": [["T-001", "T-005"]]
          },
          "estimate": {
            "type": "number",
            "description": "Time estimate in days",
            "minimum": 0.5,
            "maximum": 2,
            "multipleOf": 0.5,
            "examples": [0.5, 1, 1.5, 2]
          },
          "constitutionCheck": {
            "type": "object",
            "description": "Constitution principle compliance notes",
            "properties": {
              "security": {
                "type": "string",
                "description": "Security considerations or N/A"
              },
              "testing": {
                "type": "string",
                "description": "Test coverage requirements"
              },
              "observability": {
                "type": "string",
                "description": "Logging/metrics to be added"
              }
            }
          },
          "implementationNotes": {
            "type": "string",
            "description": "Additional implementation guidance"
          },
          "testingStrategy": {
            "type": "string",
            "description": "How to test this task (unit, integration, e2e)"
          }
        }
      }
    }
  },
  "additionalProperties": true
}
