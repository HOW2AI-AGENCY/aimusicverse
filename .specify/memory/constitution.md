<!--
Sync Impact Report
Version change: template -> 1.0.0
Modified principles: added
  - I. Тестирование (Test-First) (новое)
  - II. Безопасность и минимизация данных (новое)
  - III. Наблюдаемость и метрики (новое)
  - IV. Инкрементальная доставка и семантическое версионирование (новое)
  - V. Простота, явные контракты и документация (новое)
Added sections: expanded Governance and explicit Development Workflow
Removed sections: none
Templates requiring updates:
  - .specify/templates/plan-template.md ✅ updated
  - .specify/templates/tasks-template.md ✅ updated
  - .specify/templates/spec-template.md ⚠ pending
Follow-up TODOs: none
-->

# MusicVerse AI Constitution

## Core Principles

### I. Тестирование (Test‑First)
- Правило: Для всех новых функций и критичных исправлений тесты MUST быть написаны до реализации (TDD: тесты пишутся, тесты падают, реализация, тесты проходят).
- Требования: P1‑user stories и все изменения в foundation должны включать unit/contract/integration тесты; PR не принимается без успешного выполнения CI и прохождения тестов.
- Обоснование: Гарантирует регресс‑защиту, быстрое обнаружение ошибок и воспроизводимость поведения.

### II. Безопасность и минимизация данных
- Правило: Сбор и хранение данных MUST быть минимальными; персональные данные и секреты НЕ хранятся в репозитории (ни в явном виде, ни в истории коммитов).
- Требования: Любая интеграция с внешними сервисами должна документировать хранение/ретеншн данных и иметь план удаления; RLS и шифрование там, где это применимо.
- Обоснование: Снижает риск утечек и упрощает соответствие нормативам и ожиданиям пользователей.

### III. Наблюдаемость и метрики
- Правило: Каждая feature ветка/план MUST указывать необходимые метрики, логи и точки трассировки; ошибки MUST быть трассируемыми и категоризированными.
- Требования: Структурированные логи (JSON), метрики p95/p99 там, где это релевантно, и интеграция с существующими средствами (Sentry/GA/telemetry).
- Обоснование: Быстрая диагностика инцидентов и количественная оценка качества фич.

### IV. Инкрементальная доставка и семантическое версионирование
- Правило: Изменения доставляются мелкими, обратимыми шагами; breaking changes MUST сопровождаться документированным планом миграции и версионированием.
- Требования: Следовать MAJOR.MINOR.PATCH; добавление принципов/удаление/переопределение — MAJOR; новые обязательные разделы/значительное расширение — MINOR; формулировочные/опечаточные правки — PATCH.
- Обоснование: Уменьшает риск развертываний и делает откат/совместимость предсказуемой.

### V. Простота, явные контракты и документация
- Правило: Решения MUST быть максимально простыми; интерфейсы и контрактные форматы MUST быть явными и задокументированными.
- Требования: API/контракты должны предоставлять схемы (OpenAPI/JSON Schema), спецификации и примеры; документация обновляется в том же PR, что и код.
- Обоснование: Уменьшает когнитивную нагрузку, ускоряет интеграции и снижает технический долг.

## Операционные ограничения и стандарты

- Стек: TypeScript + React (frontend), Supabase (backend, Postgres, Edge Functions на Deno); следовать версиям, прописанным в package.json.
- CI: Все PR MUST проходить линтинг, type‑check и тесты. Merge разрешён только при зелёном CI и минимум одном утверждающем ревью от владельца компонента.
- Секреты: Использовать .env и секретное хранилище (не коммитить секреты). История репозитория, содержащая секреты, MUST быть очищена или задокументирована с планом исправления.

## Development Workflow

- Ветки: feature/..., fix/..., chore/..., hotfix/.... Именование должно быть читабельным: feature/<id>-<краткое-описание>.
- Pull Request: Каждый PR MUST содержать список изменений, ссылку на задачу/спецификацию, чеклист соответствия Конституции (tests/security/observability/docs) и статус CI.
- Code Review: Для критичных изменений требуются минимум 2 одобряющих ревью; для обычных — 1 одобрение от владельца области.
- Releases: Теги и релизы создаются по завершении MINOR/MAJOR работ; CHANGELOG обновляется при каждом MINOR/MAJOR.

## Governance

- Конституция является руководящим документом проекта; её положения приоритезируются выше практик, не соответствующих ей.

- Процедура внесения изменений:
  1. Любые изменения в Конституцию вносятся через PR с меткой `constitution:amend` и описанием причин и миграционного плана.
  2. Период обсуждения — не менее 7 дней с момента публикации PR (кроме экстренных исправлений, требующих MAINTAINERS одобрения).
  3. Для принятия изменений требуется минимум два одобряющих ревью от MAINTAINERS и зелёный CI для миграционных скриптов/проверок.
  4. После слияния поле "Last Amended" обновляется на дату слияния, а версия увеличивается согласно правилам семантического версионирования.

- Версионирование Конституции:
  - MAJOR: удаление или несовместимая переработка принципов/положений.
  - MINOR: добавление нового принципа или расширение значимого раздела.
  - PATCH: редакционные правки, уточнения и исправления опечаток.

- Compliance и проверки:
  - Каждый PR обязан включать чеклист соответствия Конституции; автоматические проверки в CI должны валидировать: наличие тестов, отсутствие секретов, базовую метрику/логирование.
  - Команда безопасности/MAINTAINERS может инициировать аудит соответствия и требовать исправлений перед слиянием.

**Version**: 1.0.0 | **Ratified**: 2025-12-01 | **Last Amended**: 2025-12-01
